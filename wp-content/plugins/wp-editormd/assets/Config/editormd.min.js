(function($,doc,win,editor){$(doc).ready(function(){try{if(doc.getElementById("wp-content-editor-container")!==null){var wpEditormd=editormd({id:"wp-content-editor-container",path:editor.editormdUrl+"/assets/Editormd/lib/",width:"100%",height:640,syncScrolling:editor.syncScrolling!=="off",watch:editor.watch!=="off",htmlDecode:editor.htmlDecode!=="off",toolbarAutoFixed:true,tocm:false,tocContainer:editor.toc==="off"?false:"",tocDropdown:false,theme:editor.theme,previewTheme:editor.previewTheme,editorTheme:editor.editorTheme,emoji:editor.emoji!=="off",tex:editor.tex!=="off",atLink:false,flowChart:editor.flowChart!=="off",sequenceDiagram:editor.sequenceDiagram!=="off",taskList:editor.taskList!=="off",placeholder:editor.placeholderEditor,prismTheme:editor.prismTheme,prismLineHighlight:false,toolbarIcons:function(){return["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","html-entities","more","pagebreak",editor.emoji!=="off"?"emoji":"toc","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"]},onfullscreen:function(){$("#wp-content-editor-container").css({position:"fixed","z-index":"99999"})},onfullscreenExit:function(){$("#wp-content-editor-container").css({position:"relative","z-index":"auto"})},toolbarIconsClass:{toc:"fa-list-alt",more:"fa-ellipsis-h"},toolbarHandlers:{toc:function(cm,icon,cursor,selection){cm.replaceSelection("[toc]")},more:function(cm,icon,cursor,selection){cm.replaceSelection("\r\n<!--more-->\r\n")}},lang:{toolbar:{toc:"The Table Of Contents",more:"More"}}});var original_wp_media_editor_insert=wp.media.editor.insert;wp.media.editor.insert=function(html){var htmlDom=doc.createElement("div");htmlDom.style.display="none";htmlDom.id="htmlDom";htmlDom.innerHTML=html;doc.body.appendChild(htmlDom);var dom=doc.getElementById("htmlDom").childNodes[0];var markdownSrc;console.log(dom.localName);switch(dom.localName){case"a":if(dom.childNodes[0].localName==="img"){markdownSrc="[![]("+dom.childNodes[0].src+")]("+dom.href+")"}else{markdownSrc="["+dom.innerText+"]("+dom.href+")"}break;case"img":var htmlSrc=doc.getElementsByClassName("alignnone")[0].src;var htmlAlt=doc.getElementsByClassName("alignnone")[0].alt;markdownSrc="!["+htmlAlt+"]("+htmlSrc+")";break;default:markdownSrc=doc.getElementById("htmlDom").innerHTML}original_wp_media_editor_insert(markdownSrc);wpEditormd.insertValue(markdownSrc);doc.getElementById("htmlDom").remove()};if(editor.emoji==="on"){editormd.emoji={path:cdn_url(editor.staticFileCDN,"emojify")+"/",ext:".png"}}if(editor.tex==="on"){editormd.katexURL={css:cdn_url(editor.staticFileCDN,"katex_config")+"/katex.min",js:cdn_url(editor.staticFileCDN,"katex_config")+"/katex.min"}}editormd.prism={url:cdn_url(editor.staticFileCDN,"prism_config")};if(editor.imagePaste==="on"){$("#wp-content-editor-container").on("paste",function(event){event=event.originalEvent;var cbd=window.clipboardData||event.clipboardData;var ua=window.navigator.userAgent;if(!(event.clipboardData&&event.clipboardData.items)){return}if(cbd.items&&cbd.items.length===2&&cbd.items[0].kind==="string"&&cbd.items[1].kind==="file"&&cbd.types&&cbd.types.length===2&&cbd.types[0]==="text/plain"&&cbd.types[1]==="Files"&&ua.match(/Macintosh/i)&&Number(ua.match(/Chrome\/(\d{2})/i)[1])<49){return}var itemLength=cbd.items.length;if(itemLength===0){return}if(itemLength===1&&cbd.items[0].kind==="string"){return}if((itemLength===1&&cbd.items[0].kind==="file")){var item=cbd.items[0];var blob=item.getAsFile();if(blob.size===0){return}function readBlobAsDataURL(blob,callback){var reader=new FileReader();reader.onload=function(e){callback(e.target.result)};reader.readAsDataURL(blob)}readBlobAsDataURL(blob,function(dataurl){var uploadingText="!["+editor.imgUploading+"]";var uploadFailText="!["+editor.imgUploadeFailed+"]";var data={action:"imagepaste_action",dataurl:dataurl};wpEditormd.insertValue(uploadingText);$.ajax({url:ajaxurl,type:"post",data:data,success:function(request){var obj=eval("("+request+")");if(obj.error){wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,uploadFailText))}else{wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,"![]("+obj.url+")"))}}})})}})}}function cdn_url(url,lib){var lib_url;if(url==="//cdn.jsdelivr.net"){switch(lib){case"emojify":lib_url=url+"/npm/emojify.js@1.1.0/dist/images/basic";break;case"katex_config":lib_url=url+"/npm/katex@0.9.0/dist";break;case"prism_config":lib_url=url+"/npm/prismjs@1.14.0";break}}else{switch(lib){case"emojify":lib_url=url+"/emojify.js/1.1.0/images/basic";break;case"katex_config":lib_url=url+"/KaTeX/0.9.0";break;case"prism_config":lib_url=url+"/ajax/libs/prism/1.14.0";break}}return lib_url}}catch(e){console.error(e)}})})(jQuery,document,window,window.Editormd);